- 하이퍼테이블 확인
```postgresql
SELECT * FROM timescaledb_information.hypertables
WHERE hypertable_name = 'candle_minute_1';
```

```postgresql
-- 하이퍼테이블 생성
SELECT create_hypertable(
               'candle_minute_1',
               'localtime', -- pk 중 시간
               chunk_time_interval => INTERVAL '1 day',
               if_not_exists => TRUE
       );
```

```postgresql
-- 일 단위 집계 뷰 생성
CREATE MATERIALIZED VIEW candle_daily_cagg
    WITH (timescaledb.continuous) AS
SELECT
    -- 일 단위로 시간 버킷팅
    time_bucket('1 day', "localtime") AS date,
    ticker,
    -- OHLCV 집계
    FIRST(open, "localtime") AS open,    -- 그날 첫 open (시가)
    MAX(high) AS high,                  -- 그날 최고가
    MIN(low) AS low,                    -- 그날 최저가
    LAST(close, "localtime") AS close,    -- 그날 마지막 close (종가)
    SUM(volume) AS volume               -- 그날 총 거래량
FROM candle_minute_1
GROUP BY time_bucket('1 day', "localtime"), ticker;
```

```postgresql
--  자동 갱신 정책 추가
SELECT add_continuous_aggregate_policy('candle_daily_cagg',
                                       start_offset => INTERVAL '30 day',
                                       end_offset => INTERVAL '1 hour',
                                       schedule_interval => INTERVAL '30 minutes'
       );
```